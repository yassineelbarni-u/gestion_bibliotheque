<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:ui="jakarta.faces.facelets">
<ui:composition template="/template.xhtml">
    
    <ui:define name="title">Nouvel Emprunt</ui:define>

    <ui:define name="content">
        
        <style>
            .form-container {
                max-width: 500px;
                margin: 0 auto;
            }
            .form-group {
                margin-bottom: 20px;
            }
            .form-label {
                display: block;
                margin-bottom: 5px;
                font-weight: bold;
                color: #333;
            }
            .form-select {
                width: 100%;
                padding: 10px;
                border: 1px solid #ddd;
                border-radius: 5px;
                box-sizing: border-box;
                font-size: 14px;
                background-color: white; 
                cursor: pointer;
            }
            .form-select:focus {
                border-color: #007bff;
                outline: none;
                box-shadow: 0 0 5px rgba(0,123,255,0.2);
            }
            .error-message {
                color: #dc3545;
                font-size: 0.9em;
                margin-top: 5px;
                display: block;
            }
            .info-box {
                background: #e8f5e9;
                padding: 15px;
                border-radius: 5px;
                color: #2e7d32;
                margin-bottom: 20px;
                border-left: 5px solid #2e7d32; 
            }
            .form-actions {
                margin-top: 30px;
                display: flex;
                gap: 10px;
            }
        </style>

        <h2> Enregistrer un nouvel emprunt</h2>
        
        <h:form styleClass="form-container">
            
            <h:messages globalOnly="true" styleClass="error-message" 
                        style="margin-bottom: 15px; padding: 10px; background-color: #f8d7da; border-radius: 5px; color: #721c24;"/>
            
            <div class="form-group">
                <h:outputLabel value="Livre :" for="livre" styleClass="form-label"/>
                
                <h:selectOneMenu id="livre" value="#{empruntBean.emprunt.livreId}" required="true"
                                 styleClass="form-select"
                                 requiredMessage="Veuillez sélectionner un livre.">
                    <f:selectItem itemLabel="-- Sélectionner un livre --" itemValue="" noSelectionOption="true"/>
                    <f:selectItems value="#{empruntBean.livresDisponibles}" var="livre"
                                   itemLabel="#{livre.titre} (Stock: #{livre.stock})" 
                                   itemValue="#{livre.id}"/>
                </h:selectOneMenu>
                
                <h:message for="livre" styleClass="error-message"/>
            </div>
            
            <div class="form-group">
                <h:outputLabel value="Adhérent :" for="adherent" styleClass="form-label"/>
                
                <h:selectOneMenu id="adherent" value="#{empruntBean.emprunt.adherentId}" required="true"
                                 styleClass="form-select"
                                 requiredMessage="Veuillez sélectionner un adhérent.">
                    <f:selectItem itemLabel="-- Sélectionner un adhérent --" itemValue="" noSelectionOption="true"/>
                    <f:selectItems value="#{empruntBean.allAdherents}" var="adh"
                                   itemLabel="#{adh.nom} #{adh.prenom} " 
                                   itemValue="#{adh.id}"/>
                </h:selectOneMenu>
                
                <h:message for="adherent" styleClass="error-message"/>
            </div>
            
            <p class="info-box">
                ℹ️ <strong>Rappel :</strong> La duree de l'emprunt est fixée automatiquement à <strong>7 jours</strong>.
            </p>
            
            <div class="form-actions">
                <h:commandButton value="Valider l'emprunt" 
                                 action="#{empruntBean.emprunter}"
                                 styleClass="btn btn-primary"/>
                
                <h:button value="Annuler" outcome="empruntsEnCours" styleClass="btn btn-danger"/>
            </div>
            
        </h:form>
        
    </ui:define>
</ui:composition>
</html>